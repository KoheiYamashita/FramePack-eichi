# FramePack-eichi

FramePack-eichiは、lllyasviel師の[lllyasviel/FramePack](https://github.com/lllyasviel/FramePack)のフォークであるnirvash氏の[nirvash/FramePack](https://github.com/nirvash/FramePack)を元にして作成された機能追加バージョンです。nirvash氏の先駆的な改良に基づき、細かい機能が多数搭載されています。

v1.9よりKohya Tech氏許諾のもと[kohya-ss/FramePack-LoRAReady](https://github.com/kohya-ss/FramePack-LoRAReady)のコードを導入し、LoRA機能の性能と安定性が大幅に向上しています。

[https://github.com/hinablue](https://github.com/hinablue) **Hina Chen氏**より多言語対応の協力をいただき非常に感謝しております。

感謝您 [https://github.com/hinablue](https://github.com/hinablue) **Hina Chen** 對多語言支援的協助。

Special thanks to [https://github.com/hinablue](https://github.com/hinablue) **Hina Chen** for the multilingual support contribution.

[繁体字中文版说明文档请点击此处](README_zh.md)

> 注意: 現在、一部のドキュメントが繁体字中国語でも利用可能です。英語版READMEおよびその他の言語版は後日追加予定です。現在の翻訳はv1.7.1時点の機能をカバーしており、最新のv1.8機能の翻訳は現在進行中です。

![FramePack-eichi画面1](images/framepack_eichi_screenshot1.png)

## 📘 名称の由来

**Endframe Image CHain Interface (EICHI)**
- **E**ndframe: エンドフレーム機能の強化と最適化
- **I**mage: キーフレーム画像処理の改善と視覚的フィードバック
- **CH**ain: 複数のキーフレーム間の連携と関係性の強化
- **I**nterface: 直感的なユーザー体験とUI/UXの向上

「eichi」は日本語の「叡智」（深い知恵、英知）を連想させる言葉でもあり、AI技術の進化と人間の創造性を組み合わせるという本プロジェクトの哲学を象徴しています。
つまり叡智な差分画像から動画を作成することに特化した現地改修仕様です。

## 🌟 主な機能

- **多言語対応（i18n）**: 日本語、英語、繁体字中国語のUIをサポート　※v1.8.1で追加

- **高品質な動画生成**: 単一画像から自然な動きの動画を生成　※既存機能
- **柔軟な動画長設定**: 1〜20秒の各セクションモードに対応　※独自機能
- **セクションフレームサイズ設定**: 0.5秒モードと1秒モードを切り替え可能　※v1.5で追加
- **オールパディング機能**: すべてのセクションで同じパディング値を使用　※v1.4で追加
- **マルチセクション対応**: 複数のセクションでキーフレーム画像を指定し複雑なアニメーションを実現　※nirvash氏追加機能
- **セクションごとのプロンプト設定**: 各セクションに個別のプロンプトを指定可能　※v1.2で追加
- **赤枠/青枠によるキーフレーム画像効率的コピー**: 2つのキーフレームだけで全セクションをカバー可能に　※v1.7で追加
- **テンソルデータの保存と結合**: 動画の潜在表現を保存し、複数の動画を結合可能に　※v1.8で追加
- **プロンプト管理機能**: プロンプトの保存、編集、再利用が簡単　※v1.3で追加
- **MP4圧縮設定**: 動画のファイルサイズと品質のバランスを調整可能　※v1.6.2で本家からマージ
- **【試験実装中】Hunyuan LoRAサポート**: モデルのカスタマイズによる独自の表現を追加　※v1.3で追加
- **出力フォルダ管理機能**: 出力先フォルダの指定とOSに依存しない開き方をサポート ※v1.2で追加
- **ログ機能**: 詳細な経過情報や終了時に処理時間を出したりWindowsだと音を出したりします　※独自機能
- **クロスプラットフォーム対応**: Windows以外の環境でも基本機能が使用可能　※多分

![FramePack-eichi画面2](images/framepack_eichi_screenshot2.png)

## 📝 最新アップデート情報 (v1.9)

### 主要な変更点

#### 1. kohya-ss/FramePack-LoRAReadyの導入
- **LoRA機能の大幅な性能向上**: Kohya Tech氏許諾の下、LoRA適用の安定性と一貫性が向上
- **高VRAMモードと低VRAMモードの統一**: どちらのモードでも同じ直接適用方式を採用
- **コード複雑性の軽減**: 共通の`load_and_apply_lora`関数使用による保守性向上
- **DynamicSwapフック方式の廃止**: より安定した直接適用方式への完全移行

#### 2. HunyuanVideo形式への統一
- **LoRAフォーマットの標準化**: HunyuanVideo形式に統一し、異なるフォーマットの互換性を向上

## 📝 最新アップデート情報 (v1.8.1)

### 主要な変更点

#### 1. 多言語対応（i18n）の実装
- **対応言語**: 日本語、英語、繁体字中国語の3言語をサポート
- **言語切替**: 以下の実行ファイルで言語を切り替え可能
  - `run_endframe_ichi.bat` - 日本語版（デフォルト）
  - `run_endframe_ichi_en.bat` - 英語版
  - `run_endframe_ichi_zh-tw.bat` - 繁体字中国語版
- **UIの国際化**: ボタン、ラベル、メッセージなど、UIのほぼすべての要素が多言語化
- **表示言語の保存**: コマンドラインパラメータで言語選択可能（例: `--lang en`）

※ 現在は1.7.1時点の機能に対応しており、1.8の機能については今後翻訳を追加予定です。

## 📝 アップデート情報 (v1.8)

### 主要な変更点

#### 1. テンソルデータの結合機能の追加
- **テンソルデータ保存機能**: 生成した動画の潜在表現（テンソルデータ）を.safetensors形式で保存
- **テンソルデータの結合**: 保存したテンソルデータを新規生成する動画の「後方（末尾）」に結合

#### 2. VAEデコード処理の最適化
- **チャンク処理方式の導入**: 大規模テンソルを小さなチャンクに分割して効率的に処理
- **メモリ効率の向上**: GPUとCPU間の明示的なデータ移動により、メモリ使用量を削減
- **互換性の強化**: デバイスと型の明示的な調整による安定性向上

#### 3. 中間ファイル管理の改善
- **中間ファイルの自動削除**: 結合処理中に生成される中間ファイルを自動検出・削除
- **削除ファイルのフィードバック**: 削除されたファイルの情報を明示的に表示

### MP4結合処理の詳細

1. **自動結合プロセス**: テンソルデータが結合されると、対応するMP4動画も自動的に結合されます
2. **中間処理ファイル**: 結合処理中に「{ファイル名}_combined_interim_{番号}.mp4」という中間ファイルが一時的に生成され、処理完了後に自動削除されます
3. **元ファイルの保存**: 生成された元の動画ファイル「{ファイル名}.mp4」と結合動画「{ファイル名}_combined.mp4」の両方が保存されます
4. **チャンク処理による最適化**: 大きなMP4ファイルも効率的に処理され、メモリ使用量を抑えながら高品質な結合が可能です
5. **進捗表示**: 結合処理中はUI上で進捗状況が表示され、どの段階まで処理が進んでいるかを確認できます

## テンソルデータの使い方

### テンソルデータ保存機能

1. 通常の動画生成設定を行います（画像アップロード、プロンプト入力など）
2. **「テンソルデータを保存」チェックボックス**をオンにします（UI右側に追加されています）
3. **「Start Generation」**ボタンをクリックして動画を生成します
4. 生成完了時に動画（.mp4）と一緒にテンソルデータ（.safetensors）が保存されます
5. 保存されたテンソルデータは元の動画と同じファイル名（拡張子が異なる）で出力フォルダに保存されます

### テンソルデータ結合機能

1. **「テンソルデータアップロード」**欄から保存済みの.safetensorsファイルをアップロードします
2. 通常通り画像とプロンプトを設定し、**「Start Generation」**ボタンをクリックします
3. 新規動画の生成後、アップロードしたテンソルデータを「後方（末尾）」に結合した動画が自動的に生成されます
4. 結合された動画は「元のファイル名_combined.mp4」として保存されます
5. テンソルデータ保存がオンの場合、結合されたテンソルデータも保存されます

### MP4結合処理の詳細

1. **自動結合プロセス**: テンソルデータが結合されると、対応するMP4動画も自動的に結合されます
2. **中間処理ファイル**: 結合処理中に「{ファイル名}_combined_interim_{番号}.mp4」という中間ファイルが一時的に生成され、処理完了後に自動削除されます
3. **元ファイルの保存**: 生成された元の動画ファイル「{ファイル名}.mp4」と結合動画「{ファイル名}_combined.mp4」の両方が保存されます
4. **チャンク処理による最適化**: 大きなMP4ファイルも効率的に処理され、メモリ使用量を抑えながら高品質な結合が可能です
5. **進捗表示**: 結合処理中はUI上で進捗状況が表示され、どの段階まで処理が進んでいるかを確認できます

### 活用シナリオ

- **長時間動画の分割生成**: GPUメモリ制約を超える長い動画を複数のセッションに分けて生成
- **動画の連続性**: 複数のセッションをまたいで一貫性のある長い動画を作成
- **既存動画の拡張**: 以前に生成した動画に新しいシーンを追加
- **実験的な生成**: フレームを保存し、新しい生成の起点として再利用

### 終点およびキーフレーム画像の持続性問題（対応検討中）

一部のユーザーから以下の問題が報告されており、現在対応を検討中です：

- 生成中止後に再度生成を開始すると、終点およびキーフレーム画像が使用されないことがある
- 画像を一度削除して再アップロードすると問題が解決するが、生成を開始するまで問題に気づきにくい
- この問題が確認された場合、一度画像を閉じて再度アップロードし直してください
- v1.5.1でStartボタンを押した場合に明示的に画像を再取得するように見直し実施しました

### Hunyuan LoRA対応状況

v1.9で大幅に改善されました：

- kohya-ss/FramePack-LoRAReadyのコードを導入し、LoRA機能の性能と安定性が向上
- 高VRAMモードと低VRAMモードのLoRA適用方式を直接適用方式に統一
- 複雑なフック処理を排除し、load_and_apply_lora関数を共通で使用
- HunyuanVideo形式に統一し、LoRAフォーマットの互換性を向上
- 使用にはVRAM16GBでも少し厳しめですが、処理自体よりも開始前のディスク読込の方が長いです。メモリは多め推奨

## 💻 インストール方法

### 前提条件

- Windows 10/11（Linux/Macでも基本機能は多分動作可能）
- NVIDIA GPU (RTX 30/40シリーズ推奨、最低8GB VRAM)
- CUDA Toolkit 12.6
- Python 3.10.x
- 最新のNVIDIA GPU ドライバー

※ Linuxでの動作はv1.2で強化され、オープン機能も追加されましたが、一部機能に制限がある場合があります。

### 手順

#### 公式パッケージのインストール

まず、元のFramePackをインストールする必要があります。

1. [公式FramePack](https://github.com/lllyasviel/FramePack?tab=readme-ov-file#installation)からWindowsワンインストーラーをダウンロードします。
   「Click Here to Download One-Click Package (CUDA 12.6 + Pytorch 2.6)」をクリックします。

2. ダウンロードしたパッケージを解凍し、`update.bat`を実行してから`run.bat`で起動します。
   `update.bat`の実行は重要です。これを行わないと、潜在的なバグが修正されていない以前のバージョンを使用することになります。

3. 初回起動時に必要なモデルが自動的にダウンロードされます（約30GB）。
   既にダウンロード済みのモデルがある場合は、`framepack\webui\hf_download`フォルダに配置してください。

4. この時点で動作しますが、高速化ライブラリ（Xformers、Flash Attn、Sage Attn）が未インストールの場合、処理が遅くなります。
   ```
   Currently enabled native sdp backends: ['flash', 'math', 'mem_efficient', 'cudnn']
   Xformers is not installed!
   Flash Attn is not installed!
   Sage Attn is not installed!
   ```
   
   処理時間の違い: ※RAM:32GB、RXT4060Ti(16GB)の場合
   - ライブラリ未インストール時: 約4分46秒/25ステップ
   - ライブラリインストール時: 約3分17秒〜3分25秒/25ステップ

5. 高速化ライブラリをインストールするには、[Issue #138](https://github.com/lllyasviel/FramePack/issues/138)から`package_installer.zip`をダウンロードし、解凍してルートディレクトリで`package_installer.bat`を実行します（コマンドプロンプト内でEnterを押す）。

6. 再度起動してライブラリがインストールされたことを確認します:
   ```
   Currently enabled native sdp backends: ['flash', 'math', 'mem_efficient', 'cudnn']
   Xformers is installed!
   Flash Attn is not installed!
   Sage Attn is installed!
   ```
   作者が実行した場合、Flash Attnはインストールされませんでした。
   注: Flash Attnがインストールされていなくても、処理速度にはほとんど影響がありません。テスト結果によると、Flash Attnの有無による速度差はわずかで、「Flash Attn is not installed!」の状態でも約3分17秒/25ステップと、すべてインストールされている場合（約3分25秒/25ステップ）とほぼ同等の処理速度を維持できます。
   Xformersが入っているかどうかが一番影響が大きいと思います。

#### FramePack-eichiのインストール

1. 実行ファイルをFramePackのルートディレクトリに配置します：
   - `run_endframe_ichi.bat` - 日本語版用（デフォルト）
   - `run_endframe_ichi_en.bat` - 英語版用（v1.8.1で追加）
   - `run_endframe_ichi_zh-tw.bat` - 繁体字中国語版用（v1.8.1で追加）

2. 以下のファイルとフォルダを`webui`フォルダに配置します：
   - `endframe_ichi.py` - メインアプリケーションファイル
   - `eichi_utils` フォルダ - ユーティリティモジュール（v1.3.1で見直し、v1.6.2でUI関連モジュール追加）
     - `__init__.py`
     - `frame_calculator.py` - フレームサイズ計算モジュール
     - `keyframe_handler.py` - キーフレーム処理モジュール
     - `keyframe_handler_extended.py` - キーフレーム処理モジュール
     - `preset_manager.py` - プリセット管理モジュール
     - `settings_manager.py` - 設定管理モジュール
     - `ui_styles.py` - UIスタイル定義モジュール（v1.6.2で追加）
     - `video_mode_settings.py` - 動画モード設定モジュール
   - `lora_utils` フォルダ - LoRA関連モジュール（v1.3で追加、v1.9で大幅改善）
     - `__init__.py`
     - `dynamic_swap_lora.py` - LoRA管理モジュール（後方互換性用に維持）
     - `lora_loader.py` - LoRAローダーモジュール
     - `lora_check_helper.py` - LoRA適用状況確認モジュール
     - `lora_utils.py` - LoRA状態辞書マージや変換機能（v1.9で追加）
     - `fp8_optimization_utils.py` - FP8最適化機能（v1.9で追加）
   - `diffusers_helper` フォルダ - モデルのメモリ管理改善用ユーティリティ（v1.9で追加）
     - `memory.py` - メモリ管理機能を提供
     - **注意**: このディレクトリは既存の本家ツールのソースを差し替えるため、必要に応じてバックアップを取ってください
   - `locales` フォルダ - 多言語対応モジュール（v1.8.1で追加）
     - `i18n.py` - 国際化（i18n）機能のコア実装
     - `ja.json` - 日本語の翻訳ファイル（デフォルト言語）
     - `en.json` - 英語の翻訳ファイル
     - `zh-tw.json` - 繁体字中国語の翻訳ファイル

3. 希望する言語の実行ファイルを実行すると、対応する言語でFramePack-eichiのWebUIが起動します：
   - 日本語版：`run_endframe_ichi.bat`
   - 英語版：`run_endframe_ichi_en.bat`
   - 繁体字中国語版：`run_endframe_ichi_zh-tw.bat`

   または、コマンドラインから直接言語を指定して起動することも可能です：
   ```bash
   python endframe_ichi.py --lang en  # 英語で起動
   python endframe_ichi.py --lang zh-tw  # 繁体字中国語で起動
   python endframe_ichi.py  # 日本語で起動（デフォルト）
   ```

#### Linux向けインストール方法

Linuxでは、以下の手順で実行可能です：

1. 上記の必要なファイルとフォルダをダウンロードして配置します。
2. ターミナルで次のコマンドを実行します：
   ```bash
   python endframe_ichi.py
   ```

#### Google Colab向けインストール方法

- [Google Colab で FramePack を試す](https://note.com/npaka/n/n33d1a0f1bbc1)をご参考ください

#### Mac(mini M4 Pro)向けインストール方法

- [話題のFramePackをMac mini M4 Proで動かしてみた件](https://note.com/akira_kano24/n/n49651dbef319)をご参考ください

## 🚀 使い方

### 基本的な動画生成　※既存機能

1. **画像をアップロード**: 「Image」枠に画像をアップロード
2. **プロンプトを入力**: キャラクターの動きを表現するプロンプトを入力
3. **設定を調整**: 動画長やシード値を設定
4. **生成開始**: 「Start Generation」ボタンをクリック

### 高度な設定

- **生成モード選択**:　※独自機能
  - **通常モード**: 一般的な動画生成
  - **ループモード**: 最終フレームが最初のフレームに戻る循環動画を生成

- **オールパディング選択**:　※v1.4で追加、この値が小さいほど1セッションでの動きが激しくなる
  - **オールパディング**: すべてのセクションで同じパディング値を使用
  - **パディング値**: 0〜3の整数値

- **動画長設定**:　※独自機能の拡張
  - **1～20秒**

[続きはこちら](README_column.md#-高度な設定)

## 🛠️ 設定情報

### 言語設定

1. **実行ファイルによる言語選択**:
   - `run_endframe_ichi.bat` - 日本語版（デフォルト）
   - `run_endframe_ichi_en.bat` - 英語版
   - `run_endframe_ichi_zh-tw.bat` - 繁体字中国語版

2. **コマンドラインによる言語指定**:
   ```
   python endframe_ichi.py --lang en  # 英語で起動
   python endframe_ichi.py --lang zh-tw  # 繁体字中国語で起動
   python endframe_ichi.py  # 日本語で起動（デフォルト）
   ```

※ READMEの多言語版も順次対応予定です。繁体字中国語版は[README_zh.md](README_zh.md)をご参照ください。

設定に関する詳細情報は[こちら](README_column.md#-%EF%B8%8F-設定情報)をご覧ください。

## 🔧 トラブルシューティング

### h11エラーについて

ツールを立ち上げ、初回に画像をインポートする際に以下のようなエラーが多数発生することがあります：
※コンソールにエラーが表示され、GUI上では画像が表示されません。

**実際には画像はアップロードされており、サムネイルの表示に失敗しているケースが大半のため、そのまま動画生成いただくことも可能です。**

![FramePack-eichiエラー画面1](images/framepack_eichi_error_screenshot1.png)
```
ERROR:    Exception in ASGI application
Traceback (most recent call last):
  File "C:\xxx\xxx\framepack\system\python\lib\site-packages\uvicorn\protocols\http\h11_impl.py", line 404, in run_asgi
```
このエラーは、HTTPレスポンスの処理中に問題が発生した場合に表示されます。
前述のとおり、Gradioが起動し終わっていない起動初期の段階で頻発します。

解決方法：
1. 画像を一度「×」ボタンで削除して、再度アップロードしてみてください。
2. 同じファイルで何度も失敗する場合：
   - Pythonプロセスを完全に停止してからアプリケーションを再起動
   - PCを再起動してからアプリケーションを再起動

エラーが継続する場合は、他の画像ファイルを試すか、画像サイズを縮小してみてください。

### メモリ不足エラー

「CUDA out of memory」や「RuntimeError: CUDA error」が表示される場合：

1. `gpu_memory_preservation` の値を大きくする（例: 12-16GB）
2. 他のGPUを使用するアプリケーションを閉じる
3. 再起動して再試行
4. 画像解像度を下げる（640x640前後推奨）

### 動画表示の問題

一部のブラウザ（特にFirefoxなど）やmacOSで生成された動画が表示されない問題があります：

- 症状: Gradio UI上で動画が表示されない、Windowsでサムネイルが表示されない、一部のプレイヤーで再生できない
- 原因: `\framepack\webui\diffusers_helper\utils.py`内のビデオコーデック設定の問題

**こちらについては本家のMP4 Compression機能をマージし解消しました**

## 🤝 謝辞

このプロジェクトは以下のプロジェクトの貢献に基づいています：

- [lllyasviel/FramePack](https://github.com/lllyasviel/FramePack) - 原作者lllyasviel師の素晴らしい技術と革新性に感謝します
- [nirvash/FramePack](https://github.com/nirvash/FramePack) - nirvash氏の先駆的な改良と拡張に深く感謝します
- [kohya-ss/FramePack-LoRAReady](https://github.com/kohya-ss/FramePack-LoRAReady) - kohya-ss氏のLoRA対応コードの提供により、v1.9での性能向上が実現しました

## 📄 ライセンス

本プロジェクトは[Apache License 2.0](LICENSE)の下で公開されています。これは元のFramePackプロジェクトのライセンスに準拠しています。



## 📝 更新履歴

### 2025-04-30: バージョン1.9
- **kohya-ss/FramePack-LoRAReadyの導入**:
  - kohya-ss氏許諾の下、LoRA機能の性能と安定性を大幅に向上
  - 高VRAMモードと低VRAMモードのLoRA適用方式を直接適用方式に統一
  - load_and_apply_lora関数を共通で使用することでコードの複雑さが軽減
- **FP8最適化機能の導入**:
  - 8ビット浮動小数点形式を使用した量子化によるメモリ使用量と処理速度の最適化
  - 基本的にはOFFでの使用を推奨（一部環境では警告が出てエラーとなる場合あり）
  - RTX 40シリーズGPUでの高速化オプションもサポート
- **ディレクトリ構造の変更**:
  - diffusers_helper: モデルのメモリ管理改善用ユーティリティを追加
  - 既存の本家ツールのソースを差し替えるため、必要に応じてバックアップを推奨
- **HunyuanVideo形式への統一**:
  - LoRAフォーマットをHunyuanVideo形式に統一し互換性を向上

### 2025-04-29: バージョン1.8.1
- **多言語対応（i18n）の実装**:
  - 日本語、英語、繁体字中国語の3言語に対応
  - 言語別実行ファイル（`run_endframe_ichi_en.bat`、`run_endframe_ichi_zh-tw.bat`）の追加
  - UIテキスト、ログメッセージ、エラーメッセージを含むすべての要素の多言語化
  - JSONファイルベースの翻訳システムによる拡張性の向上
  - ※1.7.1時点の機能を中心に翻訳対応。1.8の機能は今後追加予定

### 2025-04-28: バージョン1.8
- **テンソルデータの結合機能を追加**:
  - 動画の潜在表現を.safetensors形式で保存する機能を追加
  - 保存したテンソルデータを新規生成する動画の後方に結合する機能を追加
  - チャンク処理方式による大規模テンソルデータの効率的な処理を実装
  - メモリ効率の向上とデバイス/型の互換性強化による安定性向上
  - 中間ファイルの自動削除機能とフィードバック表示の追加

### 2025-04-28: バージョン1.7.1
- **内部計算の最適化**:
  - 0.5秒モードのセクション数計算が正確になり、動画生成の安定性が向上
  - フレーム計算パラメータ（latent_window_size）が5から4.5に変更
- **UIの改善**:
  - 動画モード名の簡素化: 括弧付き表記を削除（例: "10(5x2)秒" → "10秒"）
  - レイアウトの整理: UI全体が整理され、より使いやすくなりました

### 2025-04-28: バージョン1.7.0
- **キーフレーム画像コピー機能の大幅改良**:
  - 赤枠/青枠による視覚的な区別を導入
  - **赤枠(セクション0)** ⇒ すべての偶数番号セクション(0,2,4,6...)に自動コピー
  - **青枠(セクション1)** ⇒ すべての奇数番号セクション(1,3,5,7...)に自動コピー
  - 動的セクション数計算の精度向上により、選択した動画長に応じて正確にコピー範囲を調整
  - ユーザーが必要に応じてコピー機能のオン/オフを切り替え可能に
- **コピー処理の安全性向上**:
  - セクション境界チェックを強化し、無効な位置へのコピーを防止
  - 詳細なログ出力によりコピー動作の追跡が容易に

### 2025-04-27: バージョン1.6.2
- **MP4圧縮設定の追加**: ※本家からマージ
  - 動画のファイルサイズと品質のバランスを調整可能に
  - 0〜100の範囲で設定可能（0=無圧縮、16=デフォルト、高い値=高圧縮・低品質）
  - 黒画面問題対策として最適な設定値を提供
- **コード品質の向上**:
  - UIスタイル定義を`ui_styles.py`として分離し、保守性と可読性を改善
  - CSSスタイルの一元管理によりUI一貫性を向上
- **フレームサイズ計算の微調整**:
  - 0.5秒モードの計算精度を向上（`latent_window_size=4.5`を使用）
  - セクション数と動画長の計算精度が向上し、より安定した動画生成が可能に

### 2025-04-26: バージョン1.6.1
- **短時間動画モードの拡充**:
  - 2秒モード: 60フレーム（2秒×30FPS）、2セクション、コピー不要
  - 3秒モード: 90フレーム（3秒×30FPS）、3セクション、キーフレーム0→1にコピー
  - 4秒モード: 120フレーム（4秒×30FPS）、4セクション、キーフレーム0→1,2にコピー
- **v1.5.1の基本構造に回帰**:
  - オリジナルのモード名表記（カッコ付き）を維持
  - キーフレームガイドHTMLを復活
  - 元々の関数構造・処理方法を維持

### 2025-04-26: バージョン1.6.0 ※却下版
- **UI/UX改善**:
  - セクション設定をアコーディオンとして分離し、必要時のみ展開可能に
  - 動画モード名の簡素化（例：「10(5x2)秒」→「10秒」）
  - キーフレーム強調表示の削除
  - 不要な機能（EndFrame影響度調整、キーフレーム自動コピー機能）を内部設定に変更
- **技術的な改善**:
  - VRAM管理の基準値変更（60GB→100GB）
  - セクション計算ロジックの改善（直接秒数から計算する機能追加）
  - フレーム数・セクション数の一貫性向上（表示秒数との整合性確保）
  - デバッグ出力の最適化

### 2025-04-25: バージョン1.5.1
- **短い動画生成向けの「1秒」モードを追加**:
  - 1秒（約30フレーム @ 30fps）に対応
- **デフォルト動画長を変更**:
  - 「6秒」から「1秒」にデフォルト値を変更
- **入力画像のコピー動作の最適化**:
  - 通常モードでの入力画像からのコピー処理を停止
  - ループモードでのみLastにコピーする処理を有効化
- **キーフレーム自動コピー機能のデフォルト値を変更**:
  - デフォルトでオフに設定し、より細かな制御を可能に
  - 必要な場合はオンにすることで自動コピー可能
- **画像処理の安定性向上**:
  - Startボタンを押した時に画像が正しく再取得されるよう改善
  - プレビュー画像の明示的なクリア処理を追加

### 2025-04-24: バージョン1.5.0
- **フレームサイズ設定の追加**:
  - 0.5秒モードと1秒モードを切り替え可能
  - フレームサイズによってlatent_window_sizeを動的に調整

### 2025-04-24: バージョン1.4.0
- **オールパディング機能の追加**:
  - すべてのセクションで同じパディング値を使用
  - この値が小さいほど1セッションでの動きが激しくなる

### 2025-04-24: バージョン1.3.3
- **LoRA適用機能の再見直し**:
  - 直接LoRAロードモードはパラメタの設定にキー一致が必要なため却下。DynamicSwapに統一して様子見
  - 取得したパラメタ数のログ表示実装

### 2025-04-24: バージョン1.3.2
- **LoRA適用機能の統一**:
  - 低VRAMモード（DynamicSwap）でも高VRAMモードと同様に直接LoRAを適用する方式に統一
  - フック方式を廃止し、より安定した直接適用方式のみをサポート
  - 互換性のためにインターフェースは維持しつつ、内部実装を改善
- **デバッグ・検証機能の強化**:
  - LoRAの適用状況を確認するための専用ユーティリティを追加（lora_check_helper.py）
  - 詳細なログ出力とデバッグ情報の提供

### 2025-04-24: バージョン1.3.1
- **コードベースのリファクタリング**: 保守性と拡張性向上のため、コードを複数のモジュールに整理
  - `eichi_utils`: キーフレーム処理、設定管理、プリセット管理、ビデオモード設定を管理
  - `lora_utils`: LoRA関連の機能を集約

### 2025-04-23: バージョン1.3
- **【調査中】Hunyuan LoRAサポートの追加**: モデルをカスタマイズして独自の表現を追加
- **【試験実装】EndFrame影響度設定の追加**: 最終フレームの影響力を0.01〜1.00の範囲で調整可能に（nirvash氏の知見）

### 2025-04-23: バージョン1.2
- **「20(4x5)秒」モードを追加**: 5パート構成の長時間動画生成に対応
- **セクションごとのプロンプト機能を追加**: 各セクションに個別のプロンプトを設定可能に【試験実装】
- **出力フォルダ管理機能を強化**: 出力先フォルダの指定とOSに依存しない開き方をサポート
- **設定ファイル管理の改善**: JSONベースの設定ファイルで設定を永続化
- **クロスプラットフォーム対応の強化**: Windows以外の環境での動作を改善

### 2025-04-22: バージョン1.1
- **「16(4x4)秒」モードを追加**: 4パート構成の長時間動画生成に対応
- **生成処理中の進捗表示を改善**: セクション情報（例：「セクション: 3/15」）が表示されるようになり、特に長い動画生成時の進捗が把握しやすくなりました
- **設定ファイルの構造化**: 動画モード設定が別ファイルに分離され、拡張性が向上

### 2025-04-21: 初版リリース
- プロンプト管理機能の最適化
- キーフレームガイド機能の追加

---
**FramePack-eichi** - Endframe Image CHain Interface  
より直感的で、より柔軟な動画生成を目指して
